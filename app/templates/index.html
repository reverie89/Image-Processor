<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processor</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        /* Add custom styles here */
        body {
            background-color: #333;
            color: #fff;
        }

        .upload-area {
            border: 2px dashed #aaa;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background-color: #444;
        }
        .upload-area.hover {
            background-color: #555; /* Change background color on hover */
        }

        #selected-file-name {
            margin-top: 10px;
            margin-bottom: 10px;
            color: #ddd;
        }
    </style>
</head>
<body>

<div class="container mt-5">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <h2 class="text-center mb-4">Image Processor</h2>
            <form method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <div class="upload-area" id="upload-area">
                        <h4>Click to select a file or drag and drop here</h4>
                        <!-- Hidden file input element -->
                        <input type="file" id="file-input" name="file" style="display: none;" accept=".zip, .jpg, .jpeg, .gif, .png, .webp">
                    </div>
                </div>
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <div class="alert alert-danger mt-4" role="alert">
                            <ul class="mb-0">
                                {% for category, message in messages %}
                                    <li>{{ message }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    {% endif %}
                {% endwith %}
                <div class="form-group">
                    <div id="selected-file-name" class="mt-3"></div>
                </div>
                <div class="form-group">
                    <label for="format">Output Format:</label>
                    <select class="form-control" id="format" name="format">
                        <option value="jpg">JPG</option>
                        <option value="png">PNG</option>
                        <option value="gif">GIF</option>
                        <option value="webp" selected>WEBP</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quality">Quality (10-100):</label>
                    <input type="number" class="form-control" id="quality" name="quality" value="75" min="10" max="100">
                </div>
                <div class="form-group">
                    <label for="width">Width:</label>
                    <input type="number" class="form-control" id="width" name="width" min="1" value="1600">
                </div>
                <button type="submit" class="btn btn-primary">Process Image</button>
            </form>
        </div>
    </div>
</div>

<script>
    // Function to update the selected file name
    function updateSelectedFileName() {
        var fileInput = document.getElementById('file-input');
        var selectedFileName = document.getElementById('selected-file-name');
        if (fileInput.files.length > 0) {
            selectedFileName.textContent = 'Selected file: ' + fileInput.files[0].name;
        } else {
            selectedFileName.textContent = '';
        }
    }

    // Event listener for file input change
    document.getElementById('file-input').addEventListener('change', function () {
        updateSelectedFileName();
    });

    // Event listener for click to open file explorer
    document.getElementById('upload-area').addEventListener('click', function () {
        document.getElementById('file-input').click();
    });

    // Event listeners for drag and drop
    var uploadArea = document.getElementById('upload-area');
    uploadArea.addEventListener('dragover', function (e) {
        e.preventDefault();
        e.stopPropagation();
        this.classList.add('hover'); // Add 'hover' class on drag over
    });

    uploadArea.addEventListener('dragleave', function (e) {
        e.preventDefault();
        e.stopPropagation();
        this.classList.remove('hover'); // Remove 'hover' class on drag leave
    });

    uploadArea.addEventListener('drop', function (e) {
        e.preventDefault();
        e.stopPropagation();
        this.classList.remove('hover'); // Remove 'hover' class on drop

        var files = e.dataTransfer.files;
        handleFiles(files);
    });

    // Call the function initially to ensure the selected file name is updated
    updateSelectedFileName();
</script>


</body>
</html>
